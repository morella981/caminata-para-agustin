<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Caminata para Agustín</title>
<style>
  body { margin:0; overflow:hidden; background:#000; }
  canvas { display:block; image-rendering: pixelated; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// IMÁGENES
const agustin = new Image(); agustin.src = "agustin.png";
const morella = new Image(); morella.src = "morella.png";

// JUGADOR
const player = { x:100, y:0, w:64, h:64, speed:4 };
const groundY = canvas.height - 100;
player.y = groundY - player.h + 8;

// CARTAS (todas desde el inicio, muy separadas)
const cartas = [
 {x:500,color:"#ffd1dc",texto:"Hola mi amor,\nespero que disfrutes\nesta caminata :)"},
 {x:900,color:"#d1e8ff",texto:"Ojalá no te empaches\ncon los chocolates\nde hoy"},
 {x:1300,color:"#e8d1ff",texto:"Sos el chico más\nlindo hasta en\nformato 2D"},
 {x:1700,color:"#d1ffe3",texto:"Se te acumulan\nlos pajaritos,\nya pensaste un nombre\npara cada uno?"},
 {x:2100,color:"#fff3d1",texto:"Apurate que te\nestoy esperando!!"},
 {x:2500,color:"#ffd1f0",texto:"Ya casi me encontrás,\nbesitoo"}
];

let cartaAbierta=null;
const pajaros=[];

// MORELLA
const morellaX = 3100;
let dialogoFinal=false;
let abrazo=false;
let camUp=0;
let finalActivo=false;

// INPUT
const keys={};
window.addEventListener("keydown",e=>keys[e.key]=true);
window.addEventListener("keyup",e=>keys[e.key]=false);
canvas.addEventListener("click",()=>{
  if(Math.abs(player.x-morellaX)<80 && !dialogoFinal && !abrazo)
    dialogoFinal=true;
});

// TEXTO
function drawBox(text){
 const boxX=canvas.width/2-300;
 const boxY=canvas.height/2-180;
 ctx.fillStyle="#fff";
 ctx.fillRect(boxX,boxY,600,280);
 ctx.strokeStyle="#e6b7d6";
 ctx.strokeRect(boxX,boxY,600,280);

 ctx.fillStyle="#444";
 ctx.font="20px Trebuchet MS";
 text.split("\n").forEach((l,i)=>{
   ctx.fillText(l,boxX+60,boxY+70+i*28);
 });

 ctx.font="14px sans-serif";
 ctx.fillText("ENTER para cerrar",boxX+220,boxY+240);
}

// UPDATE
function update(){
 if(!cartaAbierta && !dialogoFinal && !abrazo){
   if(keys["ArrowRight"]) player.x+=player.speed;
   if(keys["ArrowLeft"]) player.x-=player.speed;
 }

 cartas.forEach(c=>{
   if(!c.tomada && !cartaAbierta && Math.abs(player.x-c.x)<30){
     cartaAbierta=c;
   }
 });

 if(cartaAbierta && keys["Enter"]){
   cartaAbierta.tomada=true;
   pajaros.push({color:cartaAbierta.color});
   cartaAbierta=null;
 }

 if(Math.abs(player.x-morellaX)<60 && !dialogoFinal && !abrazo){
   player.speed=0;
 }

 if(dialogoFinal && keys["Enter"]){
   dialogoFinal=false;
   abrazo=true;
 }

 if(abrazo){
   if(player.x<morellaX-64) player.x+=1;
   else finalActivo=true;
 }

 if(finalActivo){
   camUp+=2;
 }
}

// DIBUJOS EXTRA
function drawCloud(x,y){
 ctx.fillStyle="#fff";
 ctx.fillRect(x,y,60,20);
 ctx.fillRect(x+10,y-10,40,20);
 ctx.fillRect(x+20,y-20,30,20);
}

function drawTree(x){
 ctx.fillStyle="#b58b6a";
 ctx.fillRect(x,groundY-50,20,50);
 ctx.fillStyle="#a8d5ba";
 ctx.fillRect(x-20,groundY-80,60,40);
}

// DRAW
function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 const camX=Math.max(player.x-200,0);

 // CIELO
 const g=ctx.createLinearGradient(0,0,0,canvas.height);
 g.addColorStop(0,"#f6b1c3");
 g.addColorStop(.5,"#d6c1f0");
 g.addColorStop(1,"#9fd3ff");
 ctx.fillStyle=g;
 ctx.fillRect(0,-camUp,canvas.width,canvas.height*2);

 // NUBES
 for(let i=0;i<5;i++)
   drawCloud(200+i*400-camX,100+i*20-camUp);

 // SUELO
 ctx.fillStyle="#7c9c6c";
 ctx.fillRect(0,groundY-camUp,canvas.width,100);

 // ÁRBOLES
 for(let i=0;i<6;i++)
   drawTree(300+i*500-camX);

 // CARTAS
 cartas.forEach(c=>{
   if(!c.tomada){
     ctx.fillStyle=c.color;
     ctx.fillRect(c.x-camX,groundY-30-camUp,22,30);
   }
 });

 // PÁJAROS
 pajaros.forEach((p,i)=>{
   ctx.fillStyle=p.color;
   ctx.beginPath();
   ctx.moveTo(200+i*40,300-camUp);
   ctx.lineTo(212+i*40,306-camUp);
   ctx.lineTo(224+i*40,300-camUp);
   ctx.lineTo(212+i*40,312-camUp);
   ctx.fill();
 });

 // PERSONAJES
 ctx.drawImage(agustin,player.x-camX,player.y-camUp,64,64);
 ctx.drawImage(morella,morellaX-camX,player.y-camUp,64,64);

 if(cartaAbierta) drawBox(cartaAbierta.texto);

 if(dialogoFinal)
   drawBox("¡¡Me encontraste!!\nGracias por buscarme, bancarme\ny elegirme durante estos 3 años\ny medio. Sos el mejor novio\ndel universo Agustin,\nte amo con el alma <3");

 // FINAL
 if(camUp>canvas.height){
   ctx.fillStyle="#ff6f91";
   ctx.beginPath();
   ctx.arc(canvas.width/2-70,canvas.height/2,70,0,Math.PI*2);
   ctx.arc(canvas.width/2+70,canvas.height/2,70,0,Math.PI*2);
   ctx.fillRect(canvas.width/2-140,canvas.height/2,280,140);
   ctx.fill();

   ctx.fillStyle="#fff";
   ctx.font="30px Trebuchet MS";
   ctx.fillText("Feliz San Valentín, te amo",canvas.width/2-200,canvas.height/2+40);
 }
}

function loop(){ update(); draw(); requestAnimationFrame(loop); }
loop();
</script>

</body>
</html>
