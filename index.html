<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Caminata para Agustín</title>
<style>
  body { margin:0; overflow:hidden; background:#000; }
  canvas { display:block; image-rendering: pixelated; }
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// IMÁGENES
const agustin = new Image();
agustin.src = "agustin.png";

// JUGADOR
const player = {
  x: 100,
  w: 64,
  h: 64,
  speed: 4
};

const groundY = canvas.height - 100;
player.y = groundY - player.h + 8;

// TIEMPO
const startTime = Date.now();

// CARTAS
const cartas = [
  { x: 400,  color:"#ffd1dc", texto:"Hola mi amor,\nespero que disfrutes\nesta caminata :)", tomada:false, time:0 },
  { x: 650,  color:"#d1e8ff", texto:"Ojalá no te empaches\ncon los chocolates\nde hoy", tomada:false, time:10000 },
  { x: 900,  color:"#e8d1ff", texto:"Sos el chico más\nlindo hasta en\nformato 2D", tomada:false, time:20000 },
  { x: 1150, color:"#d1ffe3", texto:"Se te acumulan\nlos pajaritos,\nya pensaste un nombre\npara cada uno?", tomada:false, time:30000 },
  { x: 1400, color:"#fff3d1", texto:"Apurate que te\nestoy esperando!!", tomada:false, time:40000 },
  { x: 1650, color:"#ffd1f0", texto:"Ya casi me encontrás,\nbesitoo", tomada:false, time:50000 }
];

let cartaAbierta = null;

// PÁJAROS
const pajaros = [];

// INPUT
const keys = {};
window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

// TEXTO MULTILÍNEA
function drawTextBox(text, x, y, w, h) {
  ctx.fillStyle="#fff";
  ctx.fillRect(x,y,w,h);
  ctx.strokeStyle="#e6b7d6";
  ctx.strokeRect(x,y,w,h);

  ctx.fillStyle="#444";
  ctx.font="20px 'Trebuchet MS', sans-serif";
  const lines = text.split("\n");
  lines.forEach((l,i)=>{
    ctx.fillText(l, x+20, y+50+i*28);
  });

  ctx.font="14px sans-serif";
  ctx.fillText("ENTER para cerrar", x+20, y+h-20);
}

// UPDATE
function update() {
  const elapsed = Date.now() - startTime;

  if (!cartaAbierta) {
    if (keys["ArrowRight"]) player.x += player.speed;
    if (keys["ArrowLeft"]) player.x -= player.speed;
  }

  cartas.forEach(c => {
    if (!c.tomada && !cartaAbierta && elapsed >= c.time && Math.abs(player.x - c.x) < 30) {
      cartaAbierta = c;
    }
  });

  if (cartaAbierta && keys["Enter"]) {
    cartaAbierta.tomada = true;
    pajaros.push({
      color:cartaAbierta.color,
      offsetX:Math.random()*40,
      offsetY:-70-Math.random()*20,
      flap:Math.random()*10
    });
    cartaAbierta = null;
  }

  pajaros.forEach(p=>p.flap+=0.08);
}

// DRAW
function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const camX = Math.max(player.x - 200, 0);

  // CIELO DEGRADADO
  const grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0,"#f6b1c3");
  grad.addColorStop(0.5,"#d6c1f0");
  grad.addColorStop(1,"#9fd3ff");
  ctx.fillStyle=grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // NUBES
  ctx.fillStyle="#fff";
  for(let i=0;i<5;i++){
    const x = i*350 - camX*0.3;
    ctx.fillRect(x,100,80,30);
    ctx.fillRect(x+20,80,60,30);
  }

  // ÁRBOLES
  for(let i=0;i<8;i++){
    const x=i*300-camX;
    ctx.fillStyle="#b08968";
    ctx.fillRect(x,groundY-60,20,60);
    ctx.fillStyle="#a3d9a5";
    ctx.fillRect(x-20,groundY-100,60,40);
  }

  // SUELO
  ctx.fillStyle="#7c9c6c";
  ctx.fillRect(0,groundY,canvas.width,100);

  // CARTAS
  cartas.forEach(c=>{
    if(!c.tomada && Date.now()-startTime>=c.time){
      ctx.fillStyle=c.color;
      ctx.fillRect(c.x-camX,groundY-30,22,30);
    }
  });

  // PÁJAROS ORIGAMI
  pajaros.forEach((p,i)=>{
    const x=player.x-camX+p.offsetX+i*14;
    const y=player.y+p.offsetY+Math.sin(p.flap)*5;
    ctx.fillStyle=p.color;
    ctx.beginPath();
    ctx.moveTo(x,y);
    ctx.lineTo(x+12,y+6);
    ctx.lineTo(x+24,y);
    ctx.lineTo(x+12,y+12);
    ctx.fill();
  });

  // JUGADOR
  ctx.drawImage(agustin,player.x-camX,player.y,player.w,player.h);

  // CARTA ABIERTA
  if(cartaAbierta){
    drawTextBox(
      cartaAbierta.texto,
      canvas.width/2-260,
      canvas.height/2-140,
      520,
      260
    );
  }
}

// LOOP
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
